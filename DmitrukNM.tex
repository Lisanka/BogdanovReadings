\documentclass[11pt,twoside]{article}

\usepackage[T2A]{fontenc}
\usepackage{amsmath}
\usepackage{amssymb,latexsym}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{wrapfig}

\usepackage{epsf}
\usepackage{eucal,eufrak}
\usepackage{epic}
\usepackage{eepic}

\usepackage[cp1251]{inputenc}
\usepackage[english, russian]{babel}

\setlength{\textwidth}{162mm} \setlength{\textheight}{240mm}
\setlength{\topmargin}{-1mm} \addtolength{\oddsidemargin}{-13mm}
\addtolength{\evensidemargin}{-31mm} \setlength{\baselineskip}{18pt}
\headheight=5.0mm % место для колонтитула
\headsep=3.6mm % отступ после колонтитула
\footskip=7.1mm % расстояние до колонтитула

\begin{document}
\begin{center}
{\bf ОДИН МЕТОД ОПТИМАЛЬНОГО УПРАВЛЕНИЯ\\ ЛИНЕЙНЫМИ СИСТЕМАМИ БЕЗ ПРЕДВАРИТЕЛЬНОЙ \\ ПАРАМЕТРИЧЕСКОЙ ИДЕНТИФИКАЦИИ СИСТЕМЫ}
\end{center}

\begin{center}
{\bf Н.М. Дмитрук, Е.А. Манжулина}
\end{center}

\begin{center}
{\footnotesize Белорусский государственный университет, Минск,
Беларусь\\
\textsf{\{dmitrukn,fpm.manzhuli\}@bsu.by} }
\end{center}

Рассмотрим линейную  стационарную дискретную систему $G$, минимальная реализация  $(A,B,C,D)$ которой известна:
\begin{align}\label{model}
    & x(t+1) = Ax(t) + Bu(t),  \ \ x(0) = x_0, \\
    & y(t) = Cx(t) + Du(t), \ \ t = 0, \ldots, T-1.\nonumber
    \end{align}
Здесь $x(t) \in \mathbb{R}^n$, $u(t) \in \mathbb{R}^m$, $y(t) \in \mathbb{R}^p$ --- состояние системы, управление и выходной сигнал в момент времени $t$, $(A,B)$ --- управляема, $(A,C)$ --- наблюдаема.

Траекторией системы $G$ будем называть пару $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ из управления и выходного сигнала,  удовлетворяющую (\ref{model}) при некотором (наблюдателю неизвестном) начальном состоянии $x(0) \in \mathbb{R}^n$. 
В каждом конкретном процессе управления реализуется некоторая  траектория $\{u^p, y^p\} = \{u^p(t), y^p(t)\}_{t=0}^{T-1}$ системы $G$, которая определяется реализовавшимся, но наблюдателю неизвестным начальным состоянием $x_0^p\in X_0$ и поданным на вход системы  (\ref{model}) управлением $u^p$. Далее будем считать, что в процессе управления доступны лишь неточные измерения выходных сигналов вида
$
    \tilde{y}^p(t) = y^p(t) + \xi(t), \ \  t = 0, \ldots, T - 1,
     $
где $\xi(t) \in \Xi = \{ \xi \in \mathbb{R}^p :  ||\xi||_{\infty} \leq \varepsilon $ ---  неизвестная ограниченная ошибка измерения в момент времени $t$.
%Величина реализовавшейся ошибки $\xi(t)$ достоверно неизвестна, однако полагаем ее в дальнейшем принадлежащей известному множеству $\Xi = \{ \xi \in \mathbb{R}^p :  ||\xi||_{\infty} \leq \varepsilon \}$, т.е. $\xi(t) \in \Xi$, $t = 0, \ldots, T - 1$, где $||\cdot||_{\infty}$ --- равномерная норма.

Поставим задачу о минимизации энергетических затрат на управление системой $J(u) = \sum\limits_{t = 0}^{T-1} \left\rVert{u(t)}\right\rVert^2$ на множестве доступных управляющих воздействий $u(t) \in U = \{u \in \mathbb{R}^m : u_{\min} \leq u \leq u_{\max} \}$, гарантирующих выполнение ограничений на выходные сигналы $y(t) \in Y(t) = \{ y \in \mathbb{R}^p: G(t)y \leq g(t) \}$, $G(t) \in \mathbb{R}^{q \times p}$, $g(t) \in \mathbb{R}^q$, $t = 0, \ldots, T-1$ при всех возможных реализациях начального состояния $x(0) \in X_0 = \{ x\in \mathbb{R}^n : x_{\min} \leq x \leq x_{\max} \}$. В данной задаче для построения оптимальной обратной связи по неточным измерениям может быть использовна модификация результатов работы [1].

В докладе исследуется случай, когда реализация $(A,B,C,D)$ системы в пространстве состояний не известна. Классический подход в подобных ситуациях состоит в предварительной идентификации системы и последующей формулировке и решении рассмотренной выше задачи. В настоящей работе будет предложен альтернативный подход, не нуждающийся в явном параметрическом представлении системы. Вместо модели $(A,B,C,D)$ будем использовать полученное в [2] представление любой траектории системы $G$ на основе одной предварительно сгенерированной траектории из управления и выходного сигнала
$
    \{u^d, y^d\} = \{u^d(t), y^d(t)\}_{t = 0}^{T^d - 1},
     $
которую далее будем называть априорной траекторией. Будем считать, что  априорная траектория $\{u^d, y^d\}$ измерена точно, для системы $G$ дана верхняя оценка размерности ее состояния $n$ (см. [2]). Также будем полагать, что управление $u^d$ является постоянно возбуждающим порядка $T$, т.е. матрица Ганкеля 
$$
H_T(u^d) = \begin{pmatrix}
  u^d(0) & \cdots & u^d(T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(\tau-1) & \cdots & u^d(\tau-1 + T^d - T) \\
  \hline
  u^d(\tau) & \cdots & u^d(\tau + T^d-T)\\
  \vdots & \ddots & \vdots \\
  u^d(T-1) & \cdots & u^d(T^d-1)
\end{pmatrix} =
		\begin{pmatrix}
		U_{\tau}^p \\
		U_{\tau}^f
		\end{pmatrix}
    $$
имеет полный строчный ранг [3]. Здесь блоки $U_{\tau}^p$ и $U_{\tau}^f$ соответствуют "прошлому"{} и "будущему"{} для момента $\tau$. Это деление потребуется в последующем при построении множества возможных траекторий  $\{u^p_\tau, u, y^p_\tau, y\}$ длины $T$ с некоторой фиксированной "прошлой"\ частью $\{u^p_\tau, y^p_\tau\} = \{u^p(t), y^p(t)\}_{t=0}^{\tau-1}$ длины $\tau$ и нефиксированной "будущей"\ частью  $\{u, y\} = \{u(t), y(t)\}_{t=\tau}^{T-1}$. Аналогичным образом разбивается построчно матрица Ганкеля $H_T(y^d)$.
%для выходного сигнала $y^d$: $H_T(y^d) = \begin{pmatrix}
%		Y_{\tau}^p \\
%		Y_{\tau}^f
%		\end{pmatrix}$. 

%{\bf Замечание 1}. {\rm Если управление $u$ является постоянно возбуждающим порядка $L$, то оно должно быть достаточно длинным: для постоянно возбуждающего управления порядка $L$ длина $L^d \geq L(m+1) - 1$.}

%Согласно \cite{Willems, BerberichAllgower}, априорная траектория $\{u^d, y^d\}$, порожденная постоянно возбуждающим управлением достаточно высокого порядка, содержат информацию, достаточную для представления любой траектории системы $G$. Далее будем использовать следующий результат работы \cite{Willems}, сформулированный в \cite{BerberichAllgower} в терминах  классических моделей в пространстве состояний:

%{\bf Теорема 1}. {\it Пусть $\{u^d, y^d\} = \{u^d(t), y^d(t)\}_{t=0}^{T^d-1}$ --- априорная траектория линейной системы $G$ размерности $n$, причем $u^d$ --- постоянно возбуждающее управление порядка $T+n$. Тогда $\{u, y\} = \{u(t), y(t)\}_{t=0}^{T-1}$ является траекторией $G$ в том и только в том случае, когда для
%$$%\begin{equation}
%\begin{pmatrix}
%H_T(u^d) \\
%H_T(y^d)
%\end{pmatrix} \alpha = \begin{pmatrix}
%u \\
%y
%\end{pmatrix}
%$$%\end{equation}
%существует решение $\alpha \in \mathbb{R}^{T^d-T+1}.$}



%В силу теоремы \ref{trajectory check}, для любых $u^p_\tau, y^p_\tau, u$ можно найти хотя бы один возможный выходной сигнал $y$, но для единственности $y$, которая представляет особый практический интерес, необходимо наложить дополнительные условия. При условии наблюдаемости пары $(A,C)$, траектория $\{u^p, y^p\}$ длины $n$ однозначно определяет начальное состояние, поэтому для обеспечения единственности достаточно потребовать $\tau \geq n$.
%
%Найдем аналог принципа разделимости управления и наблюдения для линейных систем с известной моделью в пространстве состояний для случая, когда траектория системы $G$ представлена в виде (\ref{traj-cond}). Будем следовать идее декомпозиции будущего выходного сигнала $y$ (см. Приложение)
Ставя целью нахождение аналога принципа разделимости управления и наблюдения для линейных систем с известной моделью в пространстве состояний (см. [4]) для рассматриваемого случая, следуем идее декомпозиции будущего выходного сигнала $y$:
$
    y =  y_0 + \hat y,
    $
где $y_0 = \{y_0(t)\}_{t=\tau}^{T-1}$ --- выходной сигнал системы $G$, соответствующий управлению $u$ и тривиальному начальному условию $x(\tau) = 0$; $\hat y = \{\hat y(t)\}_{t=\tau}^{T-1}$ --- выходной сигнал неуправляемой системы $G$ для некоторого начального условия $x(\tau)$, согласующегося с текущей позицией процесса $\{u_\tau^p, \tilde y_\tau^p\}$. Эта идея нашла выражение в следующем результате, касающемся вопроса построения "будущей"{} части траектории с фиксированной "прошлой"{} частью. Доказательство основано на теореме 3 из [2], представляющей собой критерий принадлежности $\{u, y\}$ множеству траекторий системы $G$, сформулированный в терминах матриц Ганкеля априорных сигналов $H_T(u^d), H_T(y^d)$.

{\bf Лемма 1.} {\it Пусть $\{u_{\tau}^p, y_{\tau}^p \}$ --- некоторая фиксированная прошлая траектория системы $G$ длины $\tau \geq n$. Тогда любая траектория $\{u_{\tau}^p, u, y_{\tau}^p, y\}$ длины $T$ системы $G$ однозначно представима в виде суммы траекторий $\{0, u, 0, y_0\}$ и $\{u_{\tau}^p, 0, y_{\tau}^p, \hat{y}\}$ длины $T$, причем для фиксированного управления $u$ определить неизвестные будущие участки $y_0, \hat{y}$ можно следующим образом:\\
1. Найти некоторые решения $\hat{\alpha}(\tau)$, $\alpha_0(\tau)$ алгебраичеких уравнений
\begin{equation*}
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
u_\tau^p \\
y_\tau^p \\
0 \\
\end{pmatrix}, \quad
\begin{pmatrix}
U_\tau^p \\
Y_\tau^p \\
U_\tau^f \\
\end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
0 \\
0 \\
u \\
\end{pmatrix}.
\end{equation*}
2. Вычислить $\hat{y} = Y_\tau^f\hat{\alpha}(\tau)$, $y_0 = Y_\tau^f\alpha_0(\tau)$.
}

Лемма 1 позволяет обосновать предложенную схему управления
системой на основе априорных данных $\{u^d, y^d\}$:

\noindent при всех $\tau = n,\ldots, T-1$:

1) найти оценки $\chi_i(t|\tau)$, решив первую из задач (2) (задачу оптимального наблюдения, см. [1]) для $i = 1, \ldots, q$, $t = \tau, \ldots, T-1$;

2) найти решение  $\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$ второй из задач (2)(задачи оптимального управления, см. [1]);

3) подать на вход системы управление $u^p(\tau) = U^d(\tau)\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$.
%Как и в главе~\ref{chap2}, полученное в результате применения алгоритма управление $u^p(\tau)$, $\tau = n, \ldots, T-1$, является \textit{реализацией в конкретном процессе управления оптимальной обратной связи по неточным измерениям}.
\begin{align}
\begin{aligned}[t]
\chi_i(t|\tau) =  & \max\limits_{\hat\alpha(\tau)} \ G_i(t)Y^d(t)\hat{\alpha}(\tau), \\
    & \begin{pmatrix}
        U_\tau^p \\
        U_\tau^f \\
        \end{pmatrix} \hat{\alpha}(\tau) = \begin{pmatrix}
        u_\tau^p \\
        0 \\
        \end{pmatrix}, \nonumber \\
    & \tilde{y}_{\tau}^p-\varepsilon 1 \leq Y_\tau^p \hat{\alpha}(\tau) \leq \tilde{y}_\tau^p + \varepsilon 1
\end{aligned}
\quad 
\begin{aligned}[t]
 \min\limits_{\alpha_0(\tau)} \ & \alpha_0(\tau)^T(U_{\tau}^f)^TU_{\tau}^f\alpha_0(\tau), \\
    & \begin{pmatrix}
        U_\tau^p \\
        Y_\tau^p \\
    \end{pmatrix} \alpha_0(\tau) = \begin{pmatrix}
    0 \\
    0 \\
    \end{pmatrix},\nonumber \\
    & G(t)Y^d(t)\alpha_0(\tau) \leq g(t)- \chi(t|\tau), \nonumber\\
    & u_{\min} \leq U^d(t)\alpha_0(\tau) \leq u_{\max}, \ \
        t = \tau, \ldots, T-1,
\end{aligned}
\tag{2}
\end{align}
где $U^d(t) = (u^d(t), u^d(t+1), \ldots, u^d(t+T^d-T))$, аналогично $Y^d(t)$, $1$ --- единичный вектор.% размерность которого следует из контекста.

%На $y_0(t)$ наложим "суженное"{} условие:
%$$
%G(t)y_0(t) \leq g(t)-\chi(t|\tau), \eqno(4)
%$$
%где  $\chi(t|\tau) = (\chi_i(t|\tau), i = 1,\ldots, q)$ соответствует наихудшей реализации выходного сигнала $\hat y(t)$ в позиции $\{u_\tau^p, \tilde y^p_\tau\}$, а именно, каждый его элемент $\chi_i(t|\tau)$ является решением задачи  линейного программирования:

%Параметр $\alpha_0(\tau)$, удовлетворяющий второму из условий (\ref{cond-lemma}) и такой, что для $y_0(t) = Y^d(t)\alpha_0(\tau)$ при всех $t = \tau, \ldots, T-1$ выполняется неравенство (\ref{tightened constraint}), определяет допустимое управление $u = U_\tau^f \alpha_0(\tau)$. Тогда \textit{ задача  оптимального управления} в момент времени $\tau$ имеет вид:

%Пусть  $\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$ --- решение задачи  оптимального управления (\ref{control-qp}). На вход системы $G$ подаем первое значение соответствующего управления, которое вычисляется согласно формуле $u^*(\tau|\tau, u_\tau^p, \tilde{y}_\tau^p) = U^d(\tau)\alpha_0^*(\tau, u_\tau^p, \tilde{y}_\tau^p)$.

%Как и в главе~\ref{chap2}, полученное в результате применения алгоритма управление $u^p(\tau)$, $\tau = n, \ldots, T-1$, является \textit{реализацией в конкретном процессе управления оптимальной обратной связи по неточным измерениям}.
%
%
%Для того, чтобы результаты представленного алгоритма совпадали с результатом главы \ref{chap2} необходимо потребовать  $X_0 = \mathbb{R}^n$, совпадения управлений $u^p(t)$ при $t = 0,1,\ldots, n-1$,  и также начинать процесс управления в момент $\tau = n$.

Практическая эффективность предложенного алгоритма управления иллюстрируется примерами, а теоретическое обоснование его реализуемости дает следующий результат.
%\begin{theorem}
%Пусть в момент $\tau$ для позиции $\{u^p_\tau, \tilde y^p_\tau\}$ каждая из задач (\ref{estimation-lp}) имеет решение. Далее, пусть имеет решение задача (\ref{control-qp}) с параметрами $\chi(t|\tau)$, поставленными решениями задач (\ref{estimation-lp}). Тогда в момент $\tau+1$ для позиции $\{u^p_\tau, u^*(\tau|\tau), \tilde y^p_\tau, \tilde y^p(\tau)\}$
%задачи (\ref{estimation-lp}), (\ref{control-qp})   также имеют решение. Более того, $$
%    \sum\limits_{t=\tau+1}^{T-1}\norm{u^*(t|\tau+1)}^2 \leq \sum\limits_{t=\tau+1}^{T-1}\norm{u^*(t|\tau)}^2.
%    $$
%\end{theorem}

{\bf Теорема 1.}{ \it Если задачи оптимального наблюдения и управления () имеют решение в момент времени $\tau=n$, то они разрешимы и в каждый из последующих моментов $\tau = n+1, \ldots, T-1$. При этом критерий качества, значение которого определяется в момент $\tau$ как
$
    J(\tau) = \sum\limits_{t=0}^{\tau-1}||u^p(t)||^2 + \sum\limits_{t=\tau}^{T-1}||u^*(t|\tau)||^2,
    $
является невозрастающей функцией от $\tau$.}

\vspace{-1ex}{\small
\begin{center}{\bf Литература}\end{center}\vspace{-1ex}






1. Габасов Р., Дмитрук Н.М., Кириллова Ф.М. {\it Оптимальное управление многомерными системами по неточным измерениям их выходных сигналов} // Труды Института математики и механики УрО РАН. 2004  Т.~10. № 2. С.~33--57.

2.Berberich J., Allg{\"o}wer F. {\it A trajectory-based framework for data-driven system analysis and control}  // European Control Conference, Saint Petersburg, Russia, 2020. P.~1365--1370.

3. Willems J. C., Markovsky I., Rapisarda P., De Moor B. L. M. {\it A note on persistency of excitation} //
Systems \& Control Letters. 2005. V. 54. P.~325--329.


4. Kurzhanskii A. B., V\'{a}lyi I.
{\it Ellipsoidal calculus for estimation and control} Nelson Thornes, 1997.


}

\newpage
\newcommand{\nn}[2]{\textit{#1}\ {#2}}
\newcommand{\avt}[3]{\textit{#1}\ {#2}\ \textsf{#3}}

\begin{center}
\bf Информация для содержания сборника
\end{center}

\nn{Дмитрук Н.М., Манжулина Е.А.}{Один метод оптимального управления линейными системами без предварительной параметрической идентификации системы}

\avt{Дмитрук Н.М.}{Белорусский государственный университет, Минск, Беларусь}{dmitrukn@bsu.by}

\avt{Манжулина Е.А.}{Белорусский государственный университет, Минск, Беларусь}{fpm.manzhuli@bsu.by}

\end{document}
